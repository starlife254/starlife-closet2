<!-- checkout.html -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Checkout - Starlife</title>
  <link rel="stylesheet" href="css/styles.css" />
  <script src="auth.js"></script>

  <script>
  const user = JSON.parse(localStorage.getItem("loggedInUser"));
  if (!user) {
    alert("‚ö†Ô∏è Please log in to continue.");
    window.location.href = "login.html";
  }
</script>

</head>
<body>
  <header>
    <nav class="navbar">
      <div class="logo">Starlife</div>
      <ul class="nav-links">
        <li><a href="index.html">Home</a></li>
        <li><a href="cart.html">Cart üõí</a></li>
      </ul>
    </nav>
  </header>

  <main class="checkout-container">
    <h1>Checkout</h1>
    <form id="checkout-form">
      <div class="form-group">
        <label for="customer-name">Full Name</label>
        <input type="text" id="customer-name" name="name" required />
      </div>


      <div class="form-group">
        <label for="email">Email</label>
        <input type="email" id="email" name="email" placeholder="xyz@gmail.com"required />
      </div>

      <div class="form-group">
        <label for="phone">Mpesa Number</label>
        <input type="tel" id="phone" name="phone" placeholder="07XXXXXXXX" required />
      </div>

      
      <div class="form-group">
        <label for="customer-address">Address</label>
        <input type="text" id="customer-address" name="address"  required />
      </div>
       <div class="form-group">
  <label for="customer-county">County</label>
  <select id="customer-county" name="county" required>
    <option value="" disabled selected>Select a county</option>
    <option value="Baringo">Baringo</option>
    <option value="Bomet">Bomet</option>
    <option value="Bungoma">Bungoma</option>
    <option value="Busia">Busia</option>
    <option value="Elgeyo-Marakwet">Elgeyo-Marakwet</option>
    <option value="Embu">Embu</option>
    <option value="Garissa">Garissa</option>
    <option value="Homa Bay">Homa Bay</option>
    <option value="Isiolo">Isiolo</option>
    <option value="Kajiado">Kajiado</option>
    <option value="Kakamega">Kakamega</option>
    <option value="Kericho">Kericho</option>
    <option value="Kiambu">Kiambu</option>
    <option value="Kilifi">Kilifi</option>
    <option value="Kirinyaga">Kirinyaga</option>
    <option value="Kisii">Kisii</option>
    <option value="Kisumu">Kisumu</option>
    <option value="Kitui">Kitui</option>
    <option value="Kwale">Kwale</option>
    <option value="Laikipia">Laikipia</option>
    <option value="Lamu">Lamu</option>
    <option value="Machakos">Machakos</option>
    <option value="Makueni">Makueni</option>
    <option value="Mandera">Mandera</option>
    <option value="Marsabit">Marsabit</option>
    <option value="Meru">Meru</option>
    <option value="Migori">Migori</option>
    <option value="Mombasa">Mombasa</option>
    <option value="Murang'a">Murang'a</option>
    <option value="Nairobi">Nairobi</option>
    <option value="Nakuru">Nakuru</option>
    <option value="Nandi">Nandi</option>
    <option value="Narok">Narok</option>
    <option value="Nyamira">Nyamira</option>
    <option value="Nyandarua">Nyandarua</option>
    <option value="Nyeri">Nyeri</option>
    <option value="Samburu">Samburu</option>
    <option value="Siaya">Siaya</option>
    <option value="Taita-Taveta">Taita-Taveta</option>
    <option value="Tana River">Tana River</option>
    <option value="Tharaka-Nithi">Tharaka-Nithi</option>
    <option value="Trans Nzoia">Trans Nzoia</option>
    <option value="Turkana">Turkana</option>
    <option value="Uasin Gishu">Uasin Gishu</option>
    <option value="Vihiga">Vihiga</option>
    <option value="Wajir">Wajir</option>
    <option value="West Pokot">West Pokot</option>
  </select>
</div>

      <div class="form-group">
        <label for="customer-city">City</label>
        <input type="text" id="customer-city" name="city" required />
      </div>

     

      

      <!-- Order Summary -->
      <div id="order-summary"></div>
      <p><strong>Subtotal:</strong> KSh <span id="total">0.00</span></p>

      <!-- Button triggers JS, not an anchor -->
      <button type="submit" class="btn">Place Order</button>
      
      
    </form>

    <div id="confirmation" class="confirmation-message"></div>
  </main>
  <!-- ‚úÖ EmailJS SDK v4 -->
<!-- ‚úÖ EmailJS SDK v3 fallback for browsers -->
<script src="https://cdn.jsdelivr.net/npm/emailjs-com@3/dist/email.min.js"></script>
<script>
  (function() {
    emailjs.init("LspaKKDYRU8KTVHvW"); // Your public key

    window.sendOrderEmail = function(order) {
      const orderItems = order.items.map(item =>
        `${item.name} x ${item.quantity || 1} ‚Äì KSh ${item.price * (item.quantity || 1)}`
      ).join('\n');

      return emailjs.send("service_ohgxkwb", "template_tpxnh6d", {
        to_name: order.customer.name,
        to_email: order.customer.email,
        order_items: orderItems,
        order_total: order.total.toLocaleString(),
        order_date: new Date(order.timestamp).toLocaleString()
      });
    };
  })();
</script>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

    <script src="js/checkout.js"></script> 
   
        <!--<script src="js/thank-you.js"></script> -->

</body>
</html>
